apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

metadata:
  name: airelgraph-backend

namespace: airelgraph

labels:
  - pairs:
      app: airelgraph
    includeSelectors: true

resources:
  - namespace.yaml
  - configmap.yaml
  - postgres.yaml
  - redis.yaml
  - deployment.yaml
  - celery-deployment.yaml
  - service.yaml
  - ingress.yaml

# Generate secrets from .env file at deploy time
# Run the deploy.sh script which copies backend/.env here before applying
secretGenerator:
  - name: backend-secrets
    envs:
      - .env
    options:
      disableNameSuffixHash: true
      labels:
        app: airelgraph
        component: backend

# Uncomment to set a custom image tag
# images:
#   - name: ghcr.io/shokubai/airelgraph/backend
#     newTag: "your-tag-here"
